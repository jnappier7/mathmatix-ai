<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>M∆THM∆TIΧ AI</title>
  <link rel="stylesheet" href="style.css" />
  <script defer src="script.js"></script>
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  </head>
<body>
  <div id="dropzone" class="fullscreen-dropzone">
    <div id="chat-container">

      <div id="top-bar">
        <button id="logoutBtn" class="btn logout">Log Out</button>
      </div>

      <img id="logo" src="/MathMatix AI Logo.png" alt="Mathmatix Logo" />

      <div id="student-dashboard-elements">
          <div id="xp-level-display">
              <span id="level-badge">Level <span id="current-level">1</span></span>
              <div id="xp-bar-container">
                  <div id="xp-progress-bar"></div>
              </div>
              <span id="xp-text"><span id="current-xp">0</span> / <span id="xp-needed">100</span> XP</span>
          </div>
          <button id="showLeaderboardBtn" class="main-action-btn">
              <img src="/leaderboard-icon.png" alt="Leaderboard Icon" class="button-icon" />
              Leaderboard
          </button>
      </div>
      <div id="chat-container-inner"></div>

      <div id="thinking-indicator" style="display: none;">
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
        <span class="thinking-text">Mathmatix is thinking...</span>
      </div>

      <div id="input-container">
        <textarea id="user-input" placeholder="Type your message here…"></textarea>
        <button id="send-button">Send</button>

        <div id="tools-left">
          <button id="insert-equation" title="Insert Equation">
            <img src="equation-icon.png" alt="Insert Equation" />
          </button>
        </div>

        <div id="tools-right">
          <button id="mic-button" title="Voice Input">
            <img src="mic-icon.png" alt="Mic" />
          </button>
          <button id="attach-button" title="Upload File">
            <img src="clip-icon.png" alt="Attach" />
          </button>
          <input type="file" id="file-input" />
        </div>
      </div>

      <div id="handsfree-toggle-wrapper">
        <span id="handsfree-label">Hands-Free Mode: OFF</span>
        <button id="handsfree-toggle" class="green"></button>
      </div>

    </div>
  </div>

  <div id="leaderboardPopup" class="popup-box hidden">
      <div class="popup-header">
          <h2>Leaderboard</h2>
          <span id="closeLeaderboard" class="close-button">❌</span>
      </div>
      <div class="overflow-x-auto">
          <table id="leaderboardTable">
              <thead>
                  <tr>
                      <th>Rank</th>
                      <th>Student</th>
                      <th>Level</th>
                      <th>XP</th>
                  </tr>
              </thead>
              <tbody>
                  <tr>
                      <td colspan="4" class="text-center py-3 text-gray-500">Loading leaderboard...</td>
                  </tr>
              </tbody>
          </table>
      </div>
  </div>

  <div id="equation-popup" class="popup">
    <div class="popup-header">
      <span>Equation Editor</span>
      <span id="close-equation-popup" class="close-button">❌</span>
    </div>

    <math-field id="math-editor" virtual-keyboard-mode="onfocus" smart-mode></math-field>

    <div class="math-controls">
      <button id="insert-latex">Insert</button>
      <button id="cancel-latex">Cancel</button>
    </div>

    <div id="equation-preview" style="margin-top: 12px; text-align: center;"></div>
  </div>

  <script src="https://unpkg.com/mathlive"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
  <script>
      $(function() {
          $("#leaderboardPopup").draggable();
      });
  </script>

  <footer>
    <p>© 2025 M∆THM∆TIΧ AI. All rights reserved.</p>
    <p>
      <a href="/privacy.html">Privacy Policy</a> |
      <a href="/terms.html">Terms of Use</a>
    </p>
  </footer>
</body>
</html>